# ğŸ³ Docker Compose: Infraestructura de EjecuciÃ³n Inteligente
# Configurado para sincronÃ­a total entre local y contenedor.

services:
  playwright-app:
    build: 
      context: .
      dockerfile: Dockerfile
    image: teoncred-qa-runner:latest
    container_name: qa-director-runner
    shm_size: '2gb' # Evita crasheos de Chromium/Firefox
    env_file: .env
    
    volumes:
      # ğŸš€ SincronÃ­a en tiempo real:
      # Cualquier cambio en local (Mapas, Lock, Specs) entra al instante.
      - .:/app
      
      # ğŸ›¡ï¸ ProtecciÃ³n de dependencias:
      # Evita que tus node_modules de Windows/Mac choquen con los de Linux.
      - /app/node_modules
      
      # ğŸ“Š Persistencia de Evidencias:
      # Saca los PDFs y reportes del contenedor a tu carpeta local.
      - ./target:/app/target
      - ./test-results:/app/test-results
      - ./playwright-report:/app/playwright-report
      
    # Variables de entorno crÃ­ticas
    environment:
      - RUN_ID=${RUN_ID:-Ejecucion_Local}
      - BROWSER=${BROWSER:-chromium}
      - REPORT_JIRA=true
      - CI=true

networks:
  default:
    name: qa_network